# 🍞 ベーカリーセンター業務完全マニュアル 要件定義書

- **プロジェクト名:** ベーカリーセンター業務マニュアル化計画
- **作成日:** 2025 年 11 月 28 日
- **作成者:** あんじゅ

---

## 1. プロジェクトの目的 (Why)

1.  **属人化の解消**
    - 現在、あんじゅさん一人に集中しているシステム・事務作業を、誰でも（パートさんや後任者）できるようにする。
    - 「あんじゅさんがいないと分からない」状態をなくす。
2.  **PC 作業の簡略化**
    - PC 操作が苦手な人でも、マニュアルの手順通りにボタンを押せば業務が完了するようにする。
    - 難しい専門用語は使わず、直感的に操作できるようにする。
3.  **技術の資産化と保守性の確保**
    - 複雑な Excel マクロや計算式のロジックを「仕様書」として明文化し、ブラックボックス化を防ぐ。
    - 将来のシステム変更やトラブル時に、スムーズに対応できるようにする。

---

## 2. ターゲットユーザー (Who)

### 🅰️ オペレーター（パート・一般社員）

- **特徴:** PC 操作には詳しくない。難しい言葉や英語のエラーが出ると不安になる。
- **利用シーン:** 日々のルーティンワーク（印刷、発注）、トラブル時の一次対応。
- **必要な情報:** 「どのファイルを開くか」「どのボタンを押すか」という具体的な操作手順。

### 🅱️ 管理者・開発者（未来の管理者・システム担当）

- **特徴:** Excel 関数や VBA、システム構造を理解・修正する必要がある人。
- **利用シーン:** 消費税率変更、ルール変更に伴う数式修正、エラーの根本解決。
- **必要な情報:** ファイルパス、VBA のコード解説、複雑な関数のロジック、システム構成図。

---

## 3. 機能要件 (Function)

- **🔍 全文検索機能:** 「発注」「ラベル」などのキーワードで、必要なページに即座にアクセスできること。
- **📱 レスポンシブ対応:** PC だけでなく、スマホやタブレットでも見やすく表示されること。
- **📋 コピーボタン:** 複雑な計算式（LET 関数など）やファイルパスを、ワンクリックでコピーできること。
- **📂 常時表示の目次:** サイドバーに常に階層構造（ディレクトリ）が表示され、迷子にならないこと。
- **🔐 セキュリティ（想定）:** 商品情報など機密性が高い情報は、Basic 認証などでアクセス制限をかける（将来的な実装含む）。

---

## 4. サイト構成・コンテンツ詳細 (Content)

### 📂 01_daily (毎日の作業)

- **日替わり表の印刷**
  - 対象: `CB商品データ.xlsm`
  - 手順: 「夜間用」シートで日付を翌日に変更 → 「一括印刷」ボタン押下。
- **翌日納品分の記録保存**
  - 対象: `T納品データ.xlsm`
  - 手順: 「集計」ボタン → 「納品記録 PDF」ボタン → 保存確認。

### 📂 02_weekly (週 2 回の作業)

- **消耗品の発注（火曜・木曜）**
  - 対象: `エフピコ発注書.xlsx`
  - **重要:** 日付計算用の `LET` 関数をコピペできるように記載。
  - フロー: J4 セルの数式コピー → A2 へ値貼り付け → 発注数入力 → メール送信（江藤さん・日下部さん宛）。

### 📂 03_monthly (月末の作業)

- **棚卸し → 清書**
  - 手順: 前月ファイル複製 → 日付更新 → 在庫数リセット → 印刷 → 記入 → 入力 → 伊藤部長へメール。
- **シフト入力 → 清書**
  - 手順: シート複製 → エラー処理（旧シート削除） → 年休コピペ → 印刷 → 入力 → PDF/PNG 変換 → LINE 送信。
  - **仕様:** 休日計算の数式（`SUM`, `COUNTIF`）についても記載。

### 📂 04_ad_hoc (随時行う作業：新商品・メンテ)

- **新商品処理フロー（ステップ分け）**
  1.  **レシピ用意:** `共有\レシピ` フォルダへ保存。
  2.  **CB 新規登録依頼:** `CB新規登録申請書.xlsx` 作成 → 本社江藤さんへメール。
  3.  **@Label 登録:** ラベラー設定、JAN コード入力、マスタ配信。
  4.  **CB 商品データ登録:** 新規入力ボタン → 商品 ID 生成 → 売価登録。
  5.  **納品データ登録:** `T商品マスタ` `T価格履歴マスター` への入力。
  6.  **数量入力・印刷:** 社長指示の数量入力 → 全店舗分出力。
  7.  **伝票用シート調整:** 行の挿入と調整。
- **終売処理:** 2 週間数量ゼロ確認後の処理手順。
- **数量変更依頼:** 本社からの依頼に基づく各店舗数量シートの修正。

### 📂 99_system_specs (🔧 システム仕様書・管理者用)

- **ファイルパス一覧:** よく使うファイルの絶対パスとショートカット場所の図解。
- **VBA マクロ解説:**
  - 各ボタン（一括印刷、PDF 保存、集計）が実行している処理の概要。
  - エラー時のデバッグ方法。
- **数式辞書 (Excel Formulas):**
  - **発注日自動計算 (LET 関数):** 曜日判定による納品日決定ロジックの解説。
  - **シフト表計算:** 半休(0.5)や特殊な休暇のカウント方法。
- **トラブルシューティング:**
  - 「コンテンツの有効化（セキュリティバー）」の対処法。
  - マクロエラー画面が出た時の緊急連絡フロー。

---

## 5. 技術スタック (Tech Stack)

- **Framework:** Next.js (Pages Router / App Router)
- **Documentation Tool:** Nextra
- **Styling:** Tailwind CSS (Nextra 内包)
- **Format:** Markdown (.md) / MDX (.mdx)
- **Deploy:** (未定: 社内サーバー or Vercel など要検討)
