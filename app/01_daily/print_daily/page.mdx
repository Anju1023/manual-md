import { Callout, Steps } from 'nextra/components';

# 🖨️ 日替わり表の印刷

翌日の製造・納品に必要な帳票類を一括で印刷します。
毎日夕方の作業です。

## 📂 対象ファイル

<Callout type="info" emoji="📄">
	**CB商品データ.xlsm** 
	
	* 場所: `デスクトップ` > `よく使う` > `商品データ`フォルダ内

</Callout>

## 📋 手順

<Steps>
### ファイルを開く
デスクトップの `よく使う` フォルダにある `CB商品データ.xlsm` を開きます。

### 「明日」ボタンを押す

「夜間用」シートの上部にある **「明日」** というボタンをクリックします。

<Callout type="success" emoji="💡">
  **これだけでOK！**
  ボタンを押すと、自動的に以下の日付がセットされます。

- **夜間用シート:** 今日 (製造日)
- **その他のシート:** 明日 (販売日)

</Callout>

### 日付の確認

念のため、シート右上の日付が正しく変わっているか確認してください。

- 例: 今日が 11/28 なら、夜間用は `11/28`、他は `11/29` になります。

### 印刷実行

シート上にある **「印刷」** ボタンを押します。
(5 枚の帳票が一括で出力されます)

</Steps>

---

## 🔧 管理者向け情報 (System Specs)

### 📅 日付設定の仕組み

各シートの日付セルには `=TODAY() + [参照セル]` という数式が入っています。
「明日」「明後日」ボタンは、この **参照セル（オフセット値）** を書き換えることで日付を制御しています。

| ボタン名     | 夜間用 (F1) | その他 (I1, E1) | 結果 (夜間 : 他)  |
| :----------- | :---------: | :-------------: | :---------------- |
| **明日**     |  `""` (0)   |       `1`       | 今日 : 明日       |
| **明後日**   |     `1`     |       `2`       | 明日 : 明後日     |
| **明々後日** |     `2`     |       `3`       | 明後日 : 明々後日 |

### 💻 ソースコード (Date Logic)

日付設定を行っているマクロの抜粋です。

```vb
Sub 明日()
    ' 画面更新停止などの定型処理省略

    Dim wsNight As Worksheet, wsAfternoon As Worksheet
    Dim wsCheck As Worksheet, wsDenpyo As Worksheet, wsCreaDenpyo As Worksheet

    ' シート定義
    Set wsNight = Worksheets("夜間用")
    Set wsAfternoon = Worksheets("昼間用")
    Set wsCheck = Worksheets("焼成後チェック")
    Set wsDenpyo = Worksheets("伝票用")
    Set wsCreaDenpyo = Worksheets("クリエ伝票用")

    ' オフセット値の設定 (夜間は当日、他は翌日)
    wsNight.Range("F1").Value = ""      ' +0日
    wsAfternoon.Range("I1").Value = 1   ' +1日
    wsCheck.Range("E1").Value = 1
    wsDenpyo.Range("E1").Value = 1
    wsCreaDenpyo.Range("E1").Value = 1

    ' 終了処理省略
End Sub
```
