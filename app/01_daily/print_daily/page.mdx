import { Callout, Steps } from 'nextra/components';

# 日替わり表の印刷

翌日の製造および納品に必要な帳票類を一括で印刷します。
毎日夕方の作業として実施してください。

## 📂 対象ファイル

<Callout type="info" emoji="📄">
	**CB商品データ.xlsm**

- **場所:** `デスクトップ` > `よく使う` > `商品データ`フォルダ内

</Callout>

## 📋 手順

<Steps>
### ファイルを開く
デスクトップの `よく使う` フォルダにある `CB商品データ.xlsm` を開きます。

### 日付の設定 (「明日」ボタン)

「夜間用」シートの上部にある **「明日」** ボタンをクリックします。
ボタンを押すことで、各シートの日付が自動的に以下の通り設定されます。

| シート名   | 日付設定       | 用途             |
| :--------- | :------------- | :--------------- |
| **夜間用** | **今日の日付** | 今夜の製造分     |
| **昼間用** | **翌日の日付** | 明日の日中製造分 |
| **その他** | **翌日の日付** | 納品・伝票用     |

<Callout type="info" emoji="✅">
	**確認ポイント** シート右上の日付が正しく変更されたことを確認してください。 
  
  * 例: 作業日が 11/28 の場合、夜間用は `11/28`、他は `11/29` となります。

</Callout>

### 印刷の実行

シート上にある **「印刷」** ボタンをクリックします。
プリンターから帳票が出力されます。

### 完了確認

以下の **計 5 種類** の帳票が出力されたことを確認してください。
※データ量により、複数枚印刷されるものがあります。

1. **夜間用**
2. **昼間用**
3. **焼成後チェック表** (※現在は 2 枚)
4. **伝票用** (※現在は 2 枚)
5. **クリエ伝票用**

<Callout type="warning" emoji="📄">
  **枚数は変動します**

店舗数や商品数が増えると、「伝票用」などの枚数は自動的に増えます（3 枚以上になることもあります）。
枚数ではなく、**「5 種類の帳票がすべて揃っているか」** を確認してください。

</Callout>
</Steps>

---

## 🔧 管理者向け情報 (System Specs)

### 📅 日付設定の仕組み

各シートの日付セルには `=TODAY() + [参照セル]` という数式が入力されています。
「明日」ボタン等のマクロは、この **参照セル（オフセット値）** を書き換えることで日付を制御しています。

- **夜間用 (F1 セル):** `""` (当日)
- **その他 (I1, E1 セル):** `1` (翌日)

### 💻 印刷マクロの仕様 (`PrintFourSheets`)

ボタンに割り当てられているマクロは `PrintFourSheets` です。
以下の 5 つのシートを順番に `PrintOut` します。

1. 夜間用
2. 昼間用
3. 焼成後チェック
4. 伝票用
5. クリエ伝票用

**注意:** `ws.PrintOut` メソッドはシートの印刷範囲全体を出力するため、行数が増えて改ページが発生した場合、自動的に複数枚が出力されます。
