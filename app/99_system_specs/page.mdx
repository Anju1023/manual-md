import { Callout, Cards } from 'nextra/components';

# 🔧 システム仕様・管理者情報 (System Specs)

ベーカリーセンター業務システムの技術的な仕様、ファイルパス、および特殊な運用ルールをまとめた管理者用ドキュメントです。
システムの修正やトラブルシューティングの際に参照してください。

## 📂 重要ファイル・パス一覧

システムで使用している主要なファイルの保存場所です。

### デスクトップ (`Desktop`)

| ファイル/フォルダ      | パス (ショートカット先)        | 用途                   |
| :--------------------- | :----------------------------- | :--------------------- |
| **CB 商品データ.xlsm** | `Desktop\よく使う\商品データ\` | 製造指示、新商品登録   |
| **T 納品データ.xlsm**  | `Desktop\よく使う\伝票作成\`   | 納品書発行、売上集計   |
| **シフト表.xlsx**      | `Desktop\よく使う\`            | 勤怠管理、シフト作成   |
| **センター棚卸表**     | `Desktop\センター棚卸表\`      | 月末在庫棚卸し         |
| **新規登録フォルダ**   | `Desktop\新規登録\`            | JAN 申請書テンプレート |

### 共有ドライブ (`Dropbox\共有`)

| フォルダ         | パス                                                                           | 用途             |
| :--------------- | :----------------------------------------------------------------------------- | :--------------- |
| **レシピ**       | `Dropbox\共有\レシピ\新ボンジュール\商品レシピ\`                               | 商品レシピの保存 |
| **ラベラー台帳** | `Dropbox\共有\TERAOKAラベラー\ラベルプリンター リスト\旧コンパクトベーカリー\` | 呼び出し番号管理 |

---

## 🤖 VBA・マクロ仕様まとめ

### CB 商品データ.xlsm

- **ID 自動生成:** `cmbCategory_Change` でカテゴリに応じた接頭辞 (`S`, `B` 等) を付与し自動採番。
- **印刷ボタン:** `PrintFourSheets` (実質 5 枚印刷) などのモジュールで、シートの表示/非表示や日付セット (`TODAY() + オフセット`) を制御。

### T 納品データ.xlsm

- **集計・PDF 保存:** `Scripting.Dictionary` を使用して集計し、`ExportAsFixedFormat` で PDF 化。
- **単価参照:** `GetPriceByCompany` 関数で、納品日時点での `T価格履歴` テーブルを参照。

---

## 🧮 重要な Excel 数式・ロジック

### シフト表.xlsx

- **日付自動表示:** シート名から月を取得。
  - `CELL("filename")` と `DATE` 関数を使用。
  - **注意:** 「年 (B1 セル)」は手動更新が必要。
- **休日計算:** `COUNTIF` で `*半*` (ワイルドカード) を 0.5 日としてカウント。
- **祝日判定:** `COUNTIF(祝日リスト, 日付)` で条件付き書式を制御。リストは 2 年分を手動更新。

### CB 商品データ (依頼ファイル作成時)

- **XLOOKUP:** 社長からの返信データを取り込む際に使用。
  - 参照後は必ず「値貼り付け」を行い、リンクを解除すること。

---

## 🛑 トラブルシューティング・FAQ

### Q. 新商品が納品書に表示されない / 金額が 0 円になる

- **A.** `T納品データ.xlsm` の `T商品マスター` および `T価格履歴` への登録漏れが原因です。CB データと連動していないため、手動登録が必要です。

### Q. シフト表で来年の祝日が赤くならない

- **A.** `祝日リスト` シートにデータが追加されていないか、条件付き書式の参照範囲 (`$B$100` 等) が不足
