import { Callout } from 'nextra/components';

# 🧩 共通関数・クラスモジュール (Common & Classes)

システム全体で共有されているクラス定義と、標準モジュールの便利関数群です。

## 📦 クラスモジュール

### `ClsItem` (商品オブジェクト)

商品マスタの 1 行分のデータを格納するクラスです。
`LoadItemDictionary` 関数により、全商品がこのクラスのインスタンスとしてメモリにロードされます。

| プロパティ                | 内容             | 備考                              |
| :------------------------ | :--------------- | :-------------------------------- |
| `ItemID`, `ItemName`      | ID, 商品名       |                                   |
| `Price`, `Price2`         | 売価, クリエ売価 |                                   |
| `Frozen`                  | 冷生地区分       | `〇` なら冷凍、`×` ならスクラッチ |
| `FrozenDaysBefore`        | 生地出し日数     | 納品日からのオフセット            |
| `QtyPerUnit`, `UnitCount` | 生地数, 何個入   | 計算用係数                        |

#### メソッド

- **`OutputQty(count)`**: 生地出し数を計算 (`count * UnitCount * QtyPerUnit`)
- **`DisplayQty(count)`**: 並べる数を計算 (`count * UnitCount`)

### `ClsLabel` (ラベル集計用)

ラベル出し表の作成時に、曜日ごとの数量と期限情報を保持するために使用されます。

---

## 🛠️ 共通関数 (標準モジュール)

### 辞書ロード系

- **`LoadItemDictionary()`**: `商品データ` テーブルを読み込み、`ClsItem` の Dictionary を返します。
- **`LoadStoreDictionary()`**: `店舗マスター` から店舗名と番号の対応表を作成します。

### 文字列・計算処理

- **`Nz(value, [default])`**: Null や空文字を `0` (または指定値) に変換します。Access の同名関数を再現。
- **`GetBaseName(fullName)`**: 商品名から「1/2」「1 本」などのサイズ表記を削除し、集計用の親名称を返します。
  - 例: `葉山レーズン 1/2本` → `葉山レーズン`
- **`ToSafeSheetName(str)`**: シート名に使用できない文字 (`/`, `\`, `?`, `*` 等) を全角文字などに置換します。

### 天板計算 (`NarabeSpill` / `NarabeSingle`)

「並べる表」などで使用される、天板枚数の計算ロジックです。

- **ロジック:**
  - 総数 ÷ 倍数 (`Multiple`) で配置数を計算。
  - 最大数 (`maxQty`) で天板枚数を割り出し、「A 枚 × B 個、C 枚 × D 個」のような文字列を生成します。
