import { Callout, Steps } from 'nextra/components';

# Step 4: CB 商品データの登録

製造指示書を作成するためのマスターデータ `CB商品データ.xlsm` に、新商品の情報を登録します。
専用の入力フォームを使用して登録を行います。

## 📂 対象ファイル

<Callout type="info" emoji="📄">
	**CB商品データ.xlsm** 
    
    * **場所:** `デスクトップ` > `よく使う` > `商品データ`
	フォルダ内

</Callout>

## 📋 登録手順

<Steps>
### フォームの起動
ファイルを開き、操作シートにある **「新規入力」** ボタンをクリックします。
入力用のフォームが表示されます。

### カテゴリの選択 (ID 自動生成)

最初に **「カテゴリ」** をリストから選択してください。
選択と同時に、システムが最新の番号を取得し、**商品 ID が自動的に入力されます。**

| カテゴリ   | ID 接頭辞 | 例    |
| :--------- | :-------: | :---- |
| 食パン     |   **S**   | S0123 |
| バケット   |   **B**   | B0123 |
| ロール     |   **R**   | R0123 |
| 菓子パン   |   **K**   | K0123 |
| 調理パン   |   **C**   | C0123 |
| ドーナツ   |   **D**   | D0123 |
| デニッシュ |   **E**   | E0123 |

<Callout type="warning" emoji="⚠️">
	**商品IDは編集しないでください**
	IDは自動採番されます。手動で書き換えると重複の原因となります。
</Callout>

### 詳細情報の入力

各項目を入力します。
特に **クリエイト用項目** は、ローゼン（店舗）と同条件であっても必ず入力が必要です。

#### 🅰️ 基本情報

| 項目名           | 説明                          | 注意点                             |
| :--------------- | :---------------------------- | :--------------------------------- |
| **商品名**       | 商品の正式名称                |                                    |
| **売価**         | 店舗 (ローゼン) での販売価格  | 税抜価格を入力                     |
| **クリエ売価**   | **クリエイト納品時** の売価   | **ローゼンと同じ場合でも必ず入力** |
| **ラベル**       | ラベラーの呼び出し番号        | Step 3 で決定した番号              |
| **クリエラベル** | **クリエイト用** 呼び出し番号 | **同じ番号でも必ず入力**           |

#### 🅱️ 製造・管理情報

製造リストへの反映に関わる重要な設定です。

| 項目名       | 設定内容・意味                                                                        |
| :----------- | :------------------------------------------------------------------------------------ |
| **金探**     | 金属探知機の設定番号                                                                  |
| **期限**     | 消費期限の日数                                                                        |
| **生地名**   | レシピ記載の生地の種類                                                                |
| **冷生地**   | **記載するリストの振分け**<br/>・`〇`: 冷凍生地出し表<br/>・`×`: スクラッチ生地出し表 |
| **並べる表** | **並べる表への記載**<br/>・`〇`: 載せる<br/>・空欄: 載せない                          |
| **生地出し** | **納品日の何日前に** 生地出しするか (日数)                                            |
| **並べ**     | **納品日の何日前に** 天板に並べるか (日数)                                            |

#### ☪️ 数量・規格 (天板計算用)

| 項目名     | 説明                                    |
| :--------- | :-------------------------------------- |
| **生地数** | 1 単位あたりの生地玉数                  |
| **何個入** | 1 袋あたりの個数                        |
| **最大数** | **天板 1 枚あたりの積載数** (Max 容量)  |
| **倍数**   | **天板への配置単位** (何個ずつ並べるか) |
| **袋**     | 使用する袋の種類                        |
| **終売**   | 販売終了フラグ (通常は空欄)             |

### 登録実行

入力内容に誤りがないか確認し、**「登録」** ボタンをクリックします。
「〜を登録しました！」というメッセージが表示されたら完了です。

</Steps>

---

## 🔧 管理者向け情報 (System Specs)

### 💻 フォームの仕様 (VBA)

- **ID 自動生成:** `cmbCategory_Change` イベントにて、カテゴリに応じた接頭辞 (S, B, R...) を付与し、既存データの最大値+1 をセットします。
- **データ登録:** `btn登録_Click` イベントにてテーブル (`ListObject`) に行を追加します。

### 📅 日付計算のロジック

「生地出し」や「並べ」に入力された数値は、各製造リストの日付計算に使用されます。

- 計算式: `対象となる製造リストの日付` = `納品日` - `設定値`
