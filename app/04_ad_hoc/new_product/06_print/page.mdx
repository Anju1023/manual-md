import { Callout, Steps } from 'nextra/components';

# Step 6: 数量入力と印刷

新商品の登録が完了したら、各店舗の製造予定数を入力します。
社長へ依頼用の Excel ファイルを送付し、入力されたデータを `XLOOKUP` 関数で一括取り込みします。

## 📂 対象ファイル

<Callout type="info" emoji="📄">
	**CB商品データ.xlsm** 
    
    
    * **場所:** `デスクトップ` > `よく使う` > `商品データ`
	フォルダ内

</Callout>

## 📋 手順 1: 依頼ファイルの作成 (⚠️ 数式保存ルール)

社長に入力してもらうための専用ファイルを加工します。

<Steps>
### シートのコピー
1. `CB商品データ.xlsm` の **「伝票用」** シートを、新しいブックにコピーします。

### 日付の変更 (最優先！)

**まだ「値貼り付け」はしません！**
先に日付を変更して、関数 (`A53` のベビアン判定や、`B5` の価格参照) を作動させます。

1. **A1 セル** の日付を **直近の「水曜日」または「土曜日」** に変更します。
2. データの表示が変わったことを確認します。

### 商品・店舗情報の「値」化

B 列のスピル配列エラーを防ぐため、先に行挿入箇所の周辺を「値」にします。

1. **A 列〜C 列 (商品名・売価・原価)** を選択 → コピー → **値貼り付け**。
2. **1 行目〜3 行目 (店舗名・番号)** を選択 → コピー → **値貼り付け**。
3. **E5 セルから右下のデータ範囲** (店舗の数量入力欄) を選択 → コピー → **値貼り付け**。

<Callout type="error" emoji="🛑">
	**消してはいけない数式**

    * **D列 (個数合計)**
    * **51行目 (金額合計)**
    * **E4行(店舗合計)**

    これらは数式のまま残してください。

</Callout>

### 新商品枠の作成 (行の入れ替えテクニック)

通常商品の一番下に枠を作ります。

1. **通常商品の「一番下の商品」** の行を選択して挿入します。
   - ※その上に空行ができます。
2. 空行に **新商品の「商品名」と「売価」** を入力します。
3. **D 列の数式** を上の行からコピーします。
4. **「元々一番下だった商品」** を **Shift キーを押しながらドラッグ** し、新商品の上に移動させます（順番の入れ替え）。

### 保存と送付

`新商品数量入力依頼.xlsx` として保存し、社長へ送付します。

</Steps>

## 📋 手順 2: データの取り込み (XLOOKUP)

(※ここは変更なし)

<Steps>
    ### 準備
    1. 返信された **「社長ファイル」** と `CB商品データ.xlsm` を両方開きます。

    ### XLOOKUP 関数で参照

    `CB商品データ` の新商品の行（店舗ごとの数量セル）に、以下の関数を入力します。

    ```excel
    =XLOOKUP($R$1, [社長ファイル]Sheet1!E3#, [社長ファイル]Sheet1!$#:$#, 0)
    ```

    _(※上記はイメージです。行と列の向きに合わせて調整してください)_

    ### 値貼り付け (絶対必須！)

    数式を入力して全店舗にコピー（オートフィル）した後、**必ず「値」に変換します。**

    1. 数式が入ったセル範囲を選択して **コピー** します。
    2. そのまま **「値貼り付け (123)」** を行います。

</Steps>
